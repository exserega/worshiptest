# üéØ **–ú–ï–¢–û–î–ò–ß–ö–ê –î–õ–Ø –ê–ì–ï–ù–¢–ê CURSOR - –ü–†–û–ï–ö–¢ AGAPE WORSHIP**

## üìã **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û –î–õ–Ø –ü–û–ù–ò–ú–ê–ù–ò–Ø –ü–†–û–ï–ö–¢–ê**

### üèóÔ∏è **–ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê (–ú–û–î–£–õ–¨–ù–ê–Ø)**

–ü—Ä–æ–µ–∫—Ç –ø—Ä–æ—à–µ–ª **–ü–û–õ–ù–£–Æ –†–ï–°–¢–†–£–ö–¢–£–†–ò–ó–ê–¶–ò–Æ** –∏–∑ –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –≤ –º–æ–¥—É–ª—å–Ω—É—é. –≠—Ç–æ **–ù–ï –û–ë–´–ß–ù–´–ô –ü–†–û–ï–ö–¢** - —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–ª—É–±–æ–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Cursor AI.

### üéØ **–¶–ï–õ–¨ –†–ï–°–¢–†–£–ö–¢–£–†–ò–ó–ê–¶–ò–ò**
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã Cursor AI**
- **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –∫–æ–¥–∞**
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å**
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π**

---

## üèõÔ∏è **–°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê**

### **üìÅ –ö–û–†–ù–ï–í–´–ï –§–ê–ô–õ–´ (LEGACY + ENTRY POINTS)**
```
/
‚îú‚îÄ‚îÄ script.js           ‚≠ê –ì–õ–ê–í–ù–ê–Ø –¢–û–ß–ö–ê –í–•–û–î–ê (934 —Å—Ç—Ä–æ–∫–∏)
‚îú‚îÄ‚îÄ ui.js              ‚≠ê LEGACY UI –§–£–ù–ö–¶–ò–ò (1431 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ firebase-init.js   üî• –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø FIREBASE v8
‚îú‚îÄ‚îÄ index.html        üåê HTML –°–¢–†–£–ö–¢–£–†–ê
‚îú‚îÄ‚îÄ styles.css        üé® –°–¢–ò–õ–ò (4963 —Å—Ç—Ä–æ–∫–∏)
‚îú‚îÄ‚îÄ sw.js             üì¶ SERVICE WORKER
‚îú‚îÄ‚îÄ manifest.json     üì± PWA –ú–ê–ù–ò–§–ï–°–¢
‚îî‚îÄ‚îÄ [HTML —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã: admin.html, login.html, settings.html]
```

### **üìÅ –ú–û–î–£–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê src/**
```
src/
‚îú‚îÄ‚îÄ core/              üèõÔ∏è –Ø–î–†–û –°–ò–°–¢–ï–ú–´
‚îÇ   ‚îú‚îÄ‚îÄ index.js       ‚≠ê –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô –≠–ö–°–ü–û–†–¢ –í–°–ï–• –ú–û–î–£–õ–ï–ô
‚îÇ   ‚îú‚îÄ‚îÄ event-bus.js   üì° –°–ò–°–¢–ï–ú–ê –°–û–ë–´–¢–ò–ô
‚îÇ   ‚îî‚îÄ‚îÄ state-manager.js üóÉÔ∏è –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–û–°–¢–û–Ø–ù–ò–ï–ú
‚îú‚îÄ‚îÄ main/              üéÆ –û–°–ù–û–í–ù–´–ï –ö–û–ù–¢–†–û–õ–õ–ï–†–´
‚îÇ   ‚îú‚îÄ‚îÄ initialization.js üöÄ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
‚îÇ   ‚îú‚îÄ‚îÄ event-handlers.js üéÆ –í–°–ï –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô
‚îÇ   ‚îî‚îÄ‚îÄ controller.js     üéØ –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê
‚îú‚îÄ‚îÄ ui/                üé® UI –ö–û–ú–ü–û–ù–ï–ù–¢–´
‚îÇ   ‚îú‚îÄ‚îÄ dom-refs.js    üìã –°–°–´–õ–ö–ò –ù–ê DOM –≠–õ–ï–ú–ï–ù–¢–´
‚îÇ   ‚îú‚îÄ‚îÄ search.js      üîç –ü–û–ò–°–ö (–æ—Å–Ω–æ–≤–Ω–æ–π)
‚îÇ   ‚îú‚îÄ‚îÄ search-manager.js üîç –ü–û–ò–°–ö –í OVERLAY
‚îÇ   ‚îú‚îÄ‚îÄ song-display.js   üì∫ –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ü–ï–°–ï–ù
‚îÇ   ‚îú‚îÄ‚îÄ overlay-manager.js üé≠ –£–ü–†–ê–í–õ–ï–ù–ò–ï OVERLAY
‚îÇ   ‚îú‚îÄ‚îÄ setlist-manager.js üéµ –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–ï–¢–õ–ò–°–¢–ê–ú–ò
‚îÇ   ‚îú‚îÄ‚îÄ setlist-selector.js üìã –î–û–ë–ê–í–õ–ï–ù–ò–ï –í –°–ï–¢–õ–ò–°–¢ (NEW)
‚îÇ   ‚îú‚îÄ‚îÄ modal-manager.js   üé≠ –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê
‚îÇ   ‚îî‚îÄ‚îÄ utils.js          üõ†Ô∏è UI –£–¢–ò–õ–ò–¢–´
‚îú‚îÄ‚îÄ api/               üîå API –°–õ–û–ô
‚îÇ   ‚îî‚îÄ‚îÄ index.js       ‚≠ê –í–ï–°–¨ API –í –û–î–ù–û–ú –§–ê–ô–õ–ï
‚îú‚îÄ‚îÄ js/                üì¶ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–û–î–£–õ–ò
‚îÇ   ‚îú‚îÄ‚îÄ state/         üóÉÔ∏è –ú–û–î–£–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï
‚îÇ   ‚îú‚îÄ‚îÄ workers/       üë∑ WEB WORKERS
‚îÇ   ‚îú‚îÄ‚îÄ utils/         üõ†Ô∏è –£–¢–ò–õ–ò–¢–´
‚îÇ   ‚îî‚îÄ‚îÄ core/          üèõÔ∏è CORE –ú–û–î–£–õ–ò
‚îÇ       ‚îî‚îÄ‚îÄ metronome.js üéµ –ú–ï–¢–†–û–ù–û–ú CORE (Web Audio API)
‚îî‚îÄ‚îÄ config/            ‚öôÔ∏è –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
    ‚îî‚îÄ‚îÄ firebase.js    üî• FIREBASE CONFIG
```

---

## üîó **–°–ò–°–¢–ï–ú–ê –ò–ú–ü–û–†–¢–û–í –ò –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô**

### **‚≠ê –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô –≠–ö–°–ü–û–†–¢: `src/core/index.js`**
```javascript
// –í–°–ï –ú–û–î–£–õ–ò –≠–ö–°–ü–û–†–¢–ò–†–£–Æ–¢–°–Ø –ß–ï–†–ï–ó –≠–¢–û–¢ –§–ê–ô–õ!
export { default as eventBus } from './event-bus.js';
export { default as stateManager } from './state-manager.js';
export { /* UI modules */ } from '../ui/dom-refs.js';
export { /* Search modules */ } from '../ui/search.js';
// ... –∏ —Ç.–¥.
```

### **üéØ –ì–õ–ê–í–ù–ê–Ø –¢–û–ß–ö–ê –í–•–û–î–ê: `script.js`**
```javascript
// –û–°–ù–û–í–ù–´–ï –ò–ú–ü–û–†–¢–´
import * as state from './state.js';          // ‚Üí src/js/state/index.js
import * as api from './api.js';              // ‚Üí Legacy API
import * as ui from './ui.js';                // ‚Üí Legacy UI
import { initializeApp } from './src/main/initialization.js';

// –ú–û–î–£–õ–¨–ù–´–ï –ò–ú–ü–û–†–¢–´ (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
import { 
  showNotificationModule,
  startAddingSongsModule,
  filterAndDisplaySongsModule
} from './src/core/index.js';

// –ì–õ–û–ë–ê–õ–¨–ù–´–ï –≠–ö–°–ü–û–†–¢–´ (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
window.showNotification = function(message, type) { /* ... */ };
window.handleSetlistSelect = function(setlist) { /* ... */ };
// ... –∏ –¥—Ä—É–≥–∏–µ legacy —Ñ—É–Ω–∫—Ü–∏–∏
```

### **üöÄ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø: `src/main/initialization.js`**
```javascript
// –ò–ú–ü–û–†–¢–´ –°–ò–°–¢–ï–ú–´
import { setupEventListeners } from './event-handlers.js';
import * as api from '../api/index.js';       // ‚Üí –ú–æ–¥—É–ª—å–Ω—ã–π API
import * as ui from '../../ui.js';            // ‚Üí Legacy UI
import searchWorkerManager from '../../src/js/workers/workerManager.js';

// –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò:
// 1. setupTheme()
// 2. setupUI()
// 3. setupEventListeners()
// 4. loadInitialData()
// 5. setupMobileOptimizations()
```

---

## üéÆ **–°–ò–°–¢–ï–ú–ê –û–ë–†–ê–ë–û–¢–ö–ò –°–û–ë–´–¢–ò–ô**

### **üìç –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô –§–ê–ô–õ: `src/main/event-handlers.js` (1131 —Å—Ç—Ä–æ–∫–∞)**

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ!

```javascript
// –°–¢–†–£–ö–¢–£–†–ê –û–ë–†–ê–ë–û–¢–ß–ò–ö–û–í:
setupEventListeners() {
  setupUIEventHandlers();      // –û—Å–Ω–æ–≤–Ω—ã–µ UI —ç–ª–µ–º–µ–Ω—Ç—ã
  setupSearchEventHandlers();  // –ü–æ–∏—Å–∫
  setupModalEventHandlers();   // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
  setupKeyboardEventHandlers(); // –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞
  setupSetlistEventHandlers(); // –°–µ—Ç–ª–∏—Å—Ç—ã –∏ –ø–∞–Ω–µ–ª–∏
  setupSongEventHandlers();    // –ü–µ—Å–Ω–∏
}
```

### **üé≠ –ü–ê–ù–ï–õ–ò –ò OVERLAY**
```javascript
// –ü–ê–ù–ï–õ–ò (–±–æ–∫–æ–≤—ã–µ)
- setlists-panel     ‚Üí –°–µ—Ç–ª–∏—Å—Ç—ã
- my-list-panel      ‚Üí –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
- repertoire-panel   ‚Üí –†–µ–ø–µ—Ä—Ç—É–∞—Ä

// OVERLAY (–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–µ)
- add-songs-overlay         ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Å–µ–Ω
- key-selection-modal       ‚Üí –í—ã–±–æ—Ä —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- mobile-song-preview-overlay ‚Üí –ú–æ–±–∏–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä
- create-setlist-modal      ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–ª–∏—Å—Ç–∞
- setlist-select-overlay    ‚Üí –í—ã–±–æ—Ä —Å–µ—Ç–ª–∏—Å—Ç–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (NEW)
```

---

## üéµ **–°–ò–°–¢–ï–ú–ê –ú–ï–¢–†–û–ù–û–ú–ê**

### **üìç –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ú–ï–¢–†–û–ù–û–ú–ê**
```javascript
// –î–í–£–•–£–†–û–í–ù–ï–í–ê–Ø –°–ò–°–¢–ï–ú–ê:
1. metronome.js (–∫–æ—Ä–µ–Ω—å)       ‚Üí UI –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
2. src/js/core/metronome.js    ‚Üí Core –ª–æ–≥–∏–∫–∞ (Web Audio API)

// –û–°–û–ë–ï–ù–ù–û–°–¢–ò:
- Web Audio API –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ç–∞–π–º–∏–Ω–≥–∞
- –í–∏–∑—É–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (beat indicators)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ localStorage
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ (2/4, 3/4, 4/4, 6/8)
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–∫—Ü–µ–Ω—Ç–∞ —Å–∏–ª—å–Ω–æ–π –¥–æ–ª–∏
```

### **üîä WEB AUDIO API –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø**
```javascript
// –ó–í–£–ö–û–í–´–ï –ü–ê–†–ê–ú–ï–¢–†–´:
const SOUND_CONFIG = {
    frequencies: {
        high: 880,  // –ê–∫—Ü–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–æ—Ç–∞
        low: 440    // –û–±—ã—á–Ω–∞—è –Ω–æ—Ç–∞
    },
    volume: {
        accent: 0.3,  // –ì—Ä–æ–º–∫–æ—Å—Ç—å –∞–∫—Ü–µ–Ω—Ç–∞
        normal: 0.15  // –û–±—ã—á–Ω–∞—è –≥—Ä–æ–º–∫–æ—Å—Ç—å
    }
};

// –í–ò–ó–£–ê–õ–¨–ù–ê–Ø –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø:
- scheduleNote() ‚Üí –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –∑–≤—É–∫ –∏ —Å–æ–±—ã—Ç–∏–µ
- 'metronome-beat' event ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç UI
- –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ —á–µ—Ä–µ–∑ lookahead
```

---

## üóÉÔ∏è **–°–ò–°–¢–ï–ú–ê –°–û–°–¢–û–Ø–ù–ò–Ø**

### **üìã –ú–û–î–£–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï: `src/js/state/`**
```javascript
// –§–ê–ô–õ–´ –°–û–°–¢–û–Ø–ù–ò–Ø:
appState.js         ‚Üí –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
metronomeState.js   ‚Üí –°–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ—Ç—Ä–æ–Ω–æ–º–∞
presentationState.js ‚Üí –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º
repertoireState.js  ‚Üí –†–µ–ø–µ—Ä—Ç—É–∞—Ä
setlistState.js     ‚Üí –°–µ—Ç–ª–∏—Å—Ç—ã

// –î–û–°–¢–£–ü –ö –°–û–°–¢–û–Ø–ù–ò–Æ:
import * as state from './state.js';
// –∏–ª–∏
window.state.currentSong
window.state.allSongs
window.state.currentSetlistId
```

### **üéØ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –°–û–°–¢–û–Ø–ù–ò–Ø**
```javascript
// –í window.state:
- allSongs              ‚Üí –í—Å–µ –ø–µ—Å–Ω–∏ –∏–∑ Firebase
- currentSong           ‚Üí –¢–µ–∫—É—â–∞—è –≤—ã–±—Ä–∞–Ω–Ω–∞—è –ø–µ—Å–Ω—è
- currentSetlistId      ‚Üí ID —Ç–µ–∫—É—â–µ–≥–æ —Å–µ—Ç–ª–∏—Å—Ç–∞
- currentSetlistName    ‚Üí –ò–º—è —Ç–µ–∫—É—â–µ–≥–æ —Å–µ—Ç–ª–∏—Å—Ç–∞
- currentVocalistId     ‚Üí ID —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–∫–∞–ª–∏—Å—Ç–∞
- currentRepertoireSongsData ‚Üí –ü–µ—Å–Ω–∏ —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä–∞
- favoriteSongs         ‚Üí –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –ø–µ—Å–Ω–∏
- addedSongsToCurrentSetlist ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–µ—Å–Ω–∏ (Set)
```

---

## üîå **API –°–ò–°–¢–ï–ú–ê**

### **‚≠ê –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô API: `src/api/index.js` (512 —Å—Ç—Ä–æ–∫)**

**–í–°–ï API –§–£–ù–ö–¶–ò–ò –í –û–î–ù–û–ú –§–ê–ô–õ–ï!**

```javascript
// –û–°–ù–û–í–ù–´–ï API –§–£–ù–ö–¶–ò–ò:
- loadAllSongsFromFirestore()    ‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –ø–µ—Å–µ–Ω
- createSetlist(name)            ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–ª–∏—Å—Ç–∞
- addSongToSetlist(id, songId, key) ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Å–Ω–∏
- loadSetlists()                 ‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ç–ª–∏—Å—Ç–æ–≤
- loadRepertoire(vocalistId, callback) ‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä–∞
- addToFavorites(song)           ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- saveSongEdit(songId, updates)  ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

// FIREBASE –ö–û–õ–õ–ï–ö–¶–ò–ò:
- "worship_songs"     ‚Üí –ü–µ—Å–Ω–∏
- "worship_setlists"  ‚Üí –°–µ—Ç–ª–∏—Å—Ç—ã
- "vocalists"         ‚Üí –í–æ–∫–∞–ª–∏—Å—Ç—ã
  - "repertoire"      ‚Üí –ü–æ–¥–∫–æ–ª–ª–µ–∫—Ü–∏—è —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä–∞
```

### **üî• FIREBASE –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø**
```javascript
// –û–°–ù–û–í–ù–û–ô: src/config/firebase.js
// LEGACY: firebase-config.js (–ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–π)

// –ò–ú–ü–û–†–¢:
import { db, auth } from '../config/firebase.js';
```

---

## üé® **UI –°–ò–°–¢–ï–ú–ê**

### **üìã DOM –≠–õ–ï–ú–ï–ù–¢–´: `src/ui/dom-refs.js`**
```javascript
// –≠–ö–°–ü–û–†–¢ –í–°–ï–• DOM –≠–õ–ï–ú–ï–ù–¢–û–í:
export const elements = {
  // –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
  sheetSelect: document.getElementById('sheet-select'),
  songSelect: document.getElementById('song-select'),
  keySelect: document.getElementById('key-select'),
  
  // –ü–∞–Ω–µ–ª–∏
  setlistsPanel: document.getElementById('setlists-panel'),
  myListPanel: document.getElementById('my-list-panel'),
  repertoirePanel: document.getElementById('repertoire-panel'),
  
  // Overlay
  addSongsOverlay: document.getElementById('add-songs-overlay'),
  keySelectionModal: document.getElementById('key-selection-modal'),
  
  // ... –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥—Ä—É–≥–∏—Ö
};
```

### **üîç –°–ò–°–¢–ï–ú–ê –ü–û–ò–°–ö–ê**
```javascript
// –û–°–ù–û–í–ù–û–ô –ü–û–ò–°–ö: src/ui/search.js
- searchSongs()              ‚Üí –ü–æ–∏—Å–∫ –ø–µ—Å–µ–Ω
- displaySearchResults()     ‚Üí –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- highlightText()            ‚Üí –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞

// –ü–û–ò–°–ö –í OVERLAY: src/ui/search-manager.js
- performOverlayDropdownSearch() ‚Üí –ü–æ–∏—Å–∫ –≤ overlay
- showOverlaySearchResults()     ‚Üí –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- filterAndDisplaySongs()        ‚Üí –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–µ—Å–µ–Ω
```

---

## ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ê–í–ò–õ–ê –î–õ–Ø –ê–ì–ï–ù–¢–ê**

### **üö® 1. HYBRID –ê–†–•–ò–¢–ï–ö–¢–£–†–ê**
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ì–ò–ë–†–ò–î–ù–£–Æ –ê–†–•–ò–¢–ï–ö–¢–£–†–£**:
- **–ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏** –≤ `src/`
- **Legacy –∫–æ–¥** –≤ –∫–æ—Ä–Ω–µ
- **–ü–µ—Ä–µ—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã** –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**–ù–ï –£–î–ê–õ–Ø–ô LEGACY –§–ê–ô–õ–´ –ë–ï–ó –ê–ù–ê–õ–ò–ó–ê –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô!**

### **üö® 2. –ì–õ–û–ë–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –í script.js**
```javascript
// –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –ì–õ–û–ë–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò:
window.showNotification()           ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
window.handleSetlistSelect()        ‚Üí –í—ã–±–æ—Ä —Å–µ—Ç–ª–∏—Å—Ç–∞
window.handleFavoriteOrRepertoireSelect() ‚Üí –í—ã–±–æ—Ä –∏–∑ –ø–∞–Ω–µ–ª–∏
window.handleVocalistChange()       ‚Üí –°–º–µ–Ω–∞ –≤–æ–∫–∞–ª–∏—Å—Ç–∞
window.handleRepertoireUpdate()     ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä–∞
window.handleAddSongToSetlist()     ‚Üí –û—Ç–∫—Ä—ã—Ç–∏–µ overlay –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (NEW)
window.openSetlistSelector()        ‚Üí –ü—Ä—è–º–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ (NEW)
```

**–≠–¢–ò –§–£–ù–ö–¶–ò–ò –ù–ï–õ–¨–ó–Ø –£–î–ê–õ–Ø–¢–¨ - –û–ù–ò –ò–°–ü–û–õ–¨–ó–£–Æ–¢–°–Ø –í event-handlers.js!**

### **üö® 3. –ò–ú–ü–û–†–¢–´ –ò –ü–£–¢–ò**
```javascript
// –ü–†–ê–í–ò–õ–¨–ù–´–ï –ü–£–¢–ò:
'./state.js'                    ‚Üí –ö–æ—Ä–Ω–µ–≤–æ–π state
'./src/core/index.js'          ‚Üí –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç
'./src/main/initialization.js' ‚Üí –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
'./src/api/index.js'          ‚Üí API
'../../ui.js'                 ‚Üí Legacy UI (–∏–∑ src/)

// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ï –ü–£–¢–ò (404 –û–®–ò–ë–ö–ò):
'./core.js'                   ‚Üí –£–¥–∞–ª–µ–Ω
'./firebase-config.js'        ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π src/config/firebase.js
'./workerManager.js'          ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π src/js/workers/workerManager.js
```

### **üö® 4. –°–û–°–¢–û–Ø–ù–ò–ï LOADING –ê–ù–ò–ú–ê–¶–ò–ô**
```javascript
// –í–°–ï–ì–î–ê –£–ë–ò–†–ê–ô LOADING –ü–û–°–õ–ï –û–ü–ï–†–ê–¶–ò–ô:
ui.toggleRepertoireButton.classList.add('loading');    // –ü–æ–∫–∞–∑–∞—Ç—å
// ... –æ–ø–µ—Ä–∞—Ü–∏—è ...
ui.toggleRepertoireButton.classList.remove('loading'); // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —É–±—Ä–∞—Ç—å!
```

### **üö® 5. –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô**
- **–í–°–ï** –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ `src/main/event-handlers.js`
- **–ù–ï –î–£–ë–õ–ò–†–£–ô** –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
- **–ü–†–û–í–ï–†–Ø–ô** –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤: `if (element) { ... }`

### **üö® 6. –î–ò–ù–ê–ú–ò–ß–ï–°–ö–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–ï–¢–õ–ò–°–¢–û–í**
```javascript
// –ü–û–°–õ–ï –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ü–ï–°–ù–ò:
1. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è handleSetlistSelect() –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ 'setlist-updated'
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ù–ï–ó–ê–í–ò–°–ò–ú–û –æ—Ç –æ—Ç–∫—Ä—ã—Ç–æ–π –ø–∞–Ω–µ–ª–∏

// –í–ê–ñ–ù–û: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –í–°–ï–ì–î–ê,
// –µ—Å–ª–∏ —Å–µ—Ç-–ª–∏—Å—Ç –≤—ã–±—Ä–∞–Ω (–Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–π –ø–∞–Ω–µ–ª–∏)
```

---

## üõ†Ô∏è **–¢–ò–ü–ò–ß–ù–´–ï –ó–ê–î–ê–ß–ò –ò –†–ï–®–ï–ù–ò–Ø**

### **üîß –î–û–ë–ê–í–õ–ï–ù–ò–ï –ù–û–í–û–ô –§–£–ù–ö–¶–ò–ò**
1. **–û–ø—Ä–µ–¥–µ–ª–∏ –º–æ–¥—É–ª—å**: UI ‚Üí `src/ui/`, API ‚Üí `src/api/index.js`
2. **–î–æ–±–∞–≤—å –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç**: `src/core/index.js`
3. **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π –≤ –Ω—É–∂–Ω–æ–º –º–µ—Å—Ç–µ**
4. **–î–æ–±–∞–≤—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π** –≤ `event-handlers.js`

### **üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–û–ö**
1. **404 –æ—à–∏–±–∫–∏** ‚Üí –ø—Ä–æ–≤–µ—Ä—å –ø—É—Ç–∏ –∏–º–ø–æ—Ä—Ç–æ–≤
2. **ReferenceError** ‚Üí –ø—Ä–æ–≤–µ—Ä—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã –≤ `script.js`
3. **–ó–∞–≤–∏—Å—à–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏** ‚Üí –¥–æ–±–∞–≤—å `.classList.remove('loading')`
4. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏** ‚Üí –ø—Ä–æ–≤–µ—Ä—å `event-handlers.js`

### **üîß –†–ê–ë–û–¢–ê –° –ü–ê–ù–ï–õ–Ø–ú–ò**
```javascript
// –û–¢–ö–†–´–¢–ò–ï –ü–ê–ù–ï–õ–ò:
ui.closeAllSidePanels();              // –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ
panel.classList.add('open');          // –û—Ç–∫—Ä—ã—Ç—å –Ω—É–∂–Ω—É—é

// –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–•:
button.classList.add('loading');      // –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
await api.loadData();                 // –ó–∞–≥—Ä—É–∑–∏—Ç—å
ui.renderData();                      // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å
button.classList.remove('loading');   // –£–±—Ä–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
```

### **üîß –†–ê–ë–û–¢–ê –° OVERLAY**
```javascript
// –ü–û–ö–ê–ó OVERLAY:
overlay.classList.add('show');     // –î–ª—è —Å—Ç–∞—Ä—ã—Ö overlay
overlay.classList.add('visible');  // –î–ª—è –Ω–æ–≤—ã—Ö (setlist-select-overlay)

// –°–ö–†–´–¢–ò–ï OVERLAY:
overlay.classList.remove('show');
overlay.classList.remove('visible');

// –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–ù–û–ü–û–ö:
// –í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–π –≤ setupModalEventHandlers()

// –í–ê–ñ–ù–û: setlist-select-overlay –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª–∞—Å—Å 'visible'!
```

### **üîß –†–ê–ë–û–¢–ê –° SETLIST SELECTOR**
```javascript
// –û–¢–ö–†–´–¢–ò–ï –°–ï–õ–ï–ö–¢–û–†–ê:
window.openSetlistSelector(song, selectedKey);

// –ú–û–î–£–õ–¨: src/ui/setlist-selector.js
// –û–°–û–ë–ï–ù–ù–û–°–¢–ò:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ç-–ª–∏—Å—Ç–æ–≤
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ç-–ª–∏—Å—Ç–∞ inline
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

// –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç modal-overlay —Å –∫–ª–∞—Å—Å–æ–º 'visible'
```

---

## üß™ **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï**

### **üìä –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–û–°–ü–û–°–û–ë–ù–û–°–¢–ò**
1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã** ‚Üí –Ω–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
2. **–ü–∞–Ω–µ–ª–∏** ‚Üí –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è, –∑–∞–≥—Ä—É–∂–∞—é—Ç –¥–∞–Ω–Ω—ã–µ, –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è
3. **–ü–æ–∏—Å–∫** ‚Üí —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –∏ overlay
4. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Å–µ–Ω** ‚Üí overlay –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –ø–µ—Å–Ω–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è
5. **–†–µ–ø–µ—Ä—Ç—É–∞—Ä** ‚Üí –≤—ã–±–æ—Ä –≤–æ–∫–∞–ª–∏—Å—Ç–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –µ–≥–æ –ø–µ—Å–Ω–∏

### **üîç –û–¢–õ–ê–î–ö–ê**
```javascript
// –ü–û–õ–ï–ó–ù–´–ï –õ–û–ì–ò:
console.log('üé≠ [Debug] Current state:', window.state);
console.log('üé≠ [Debug] All songs:', window.state.allSongs?.length);
console.log('üé≠ [Debug] Current setlist:', window.state.currentSetlistId);
```

---

## üìà **–ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨**

### **‚ö° WEB WORKERS**
- **Search Worker**: `src/js/workers/workerManager.js`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–∏—Å–∫–∞** –≤ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö
- **Fallback** –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### **üéØ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò**
- **Debounce** –¥–ª—è –ø–æ–∏—Å–∫–∞ (300ms)
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
- **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** overlay –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **–ú–æ–±–∏–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏** –≤ `initialization.js`

---

## üöÄ **–†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï**

### **üì¶ GitHub Pages**
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: `https://github.com/exserega/worshiptest`
- **URL**: `https://exserega.github.io/worshiptest/`
- **–í–µ—Ç–∫–∞**: `main`
- **–ê–≤—Ç–æ–¥–µ–ø–ª–æ–π** –ø—Ä–∏ push

### **üîÑ –ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**
```bash
git add -A
git commit -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
git push origin main
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã
```

---

## üéØ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï –î–õ–Ø –ê–ì–ï–ù–¢–ê**

### **‚úÖ –ü–û–ú–ù–ò:**
1. **–ü—Ä–æ–µ–∫—Ç –ú–û–î–£–õ–¨–ù–´–ô** - –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã
2. **Legacy –∫–æ–¥ –í–ê–ñ–ï–ù** - –Ω–µ —É–¥–∞–ª—è–π –±–µ–∑ –∞–Ω–∞–ª–∏–∑–∞
3. **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ö–†–ò–¢–ò–ß–ù–´** - –æ–Ω–∏ —Å–≤—è–∑—ã–≤–∞—é—Ç –º–æ–¥—É–ª–∏
4. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ –û–î–ù–û–ú –ú–ï–°–¢–ï** - `event-handlers.js`
5. **–í—Å–µ–≥–¥–∞ —É–±–∏—Ä–∞–π LOADING** –∞–Ω–∏–º–∞—Ü–∏–∏
6. **–¢–µ—Å—Ç–∏—Ä—É–π –í–°–ï –ü–ê–ù–ï–õ–ò** –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### **üö® –ù–ò–ö–û–ì–î–ê –ù–ï:**
- –ù–µ —É–¥–∞–ª—è–π `script.js`, `ui.js`, `state.js` - —ç—Ç–æ –æ—Å–Ω–æ–≤–∞
- –ù–µ –¥—É–±–ª–∏—Ä—É–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
- –ù–µ –∑–∞–±—ã–≤–∞–π –ø—Ä–æ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –ù–µ –∏–∑–º–µ–Ω—è–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### **üéâ –¶–ï–õ–¨ –î–û–°–¢–ò–ì–ù–£–¢–ê:**
–ü—Ä–æ–µ–∫—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã Cursor AI**. –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —á–µ—Ç–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - –≤—Å—ë –¥–ª—è —Ç–≤–æ–µ–π —É—Å–ø–µ—à–Ω–æ–π —Ä–∞–±–æ—Ç—ã!

**–£–î–ê–ß–ò –í –†–ê–ó–†–ê–ë–û–¢–ö–ï! üöÄ**