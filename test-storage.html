<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Storage</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
            max-width: 800px;
            margin: 0 auto;
        }
        .test {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
        .success { color: #4caf50; }
        .error { color: #f44336; }
        button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
    </style>
</head>
<body>
    <h1>üîç –¢–µ—Å—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –±—Ä–∞—É–∑–µ—Ä–∞</h1>
    
    <div class="test">
        <h2>1. LocalStorage Test</h2>
        <div id="local-test"></div>
        <button onclick="testLocalStorage()">Test LocalStorage</button>
    </div>
    
    <div class="test">
        <h2>2. SessionStorage Test</h2>
        <div id="session-test"></div>
        <button onclick="testSessionStorage()">Test SessionStorage</button>
    </div>
    
    <div class="test">
        <h2>3. Cookie Test</h2>
        <div id="cookie-test"></div>
        <button onclick="testCookies()">Test Cookies</button>
    </div>
    
    <div class="test">
        <h2>4. IndexedDB Test</h2>
        <div id="indexeddb-test"></div>
        <button onclick="testIndexedDB()">Test IndexedDB</button>
    </div>
    
    <div class="test">
        <h2>5. Browser Info</h2>
        <pre id="browser-info"></pre>
    </div>

    <script>
        // Browser info
        document.getElementById('browser-info').textContent = JSON.stringify({
            userAgent: navigator.userAgent,
            cookieEnabled: navigator.cookieEnabled,
            language: navigator.language,
            platform: navigator.platform,
            vendor: navigator.vendor
        }, null, 2);

        function testLocalStorage() {
            const div = document.getElementById('local-test');
            try {
                const testKey = 'test_' + Date.now();
                localStorage.setItem(testKey, 'test value');
                const value = localStorage.getItem(testKey);
                localStorage.removeItem(testKey);
                
                if (value === 'test value') {
                    div.innerHTML = '<span class="success">‚úÖ LocalStorage —Ä–∞–±–æ—Ç–∞–µ—Ç</span>';
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º Firebase –∫–ª—é—á–∏
                    const firebaseKeys = [];
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (key && key.includes('firebase')) {
                            firebaseKeys.push(key);
                        }
                    }
                    div.innerHTML += '<br>Firebase keys: ' + (firebaseKeys.length > 0 ? firebaseKeys.join(', ') : '–ù–ï–¢');
                } else {
                    throw new Error('Value mismatch');
                }
            } catch (e) {
                div.innerHTML = '<span class="error">‚ùå LocalStorage –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç: ' + e.message + '</span>';
            }
        }

        function testSessionStorage() {
            const div = document.getElementById('session-test');
            try {
                const testKey = 'test_' + Date.now();
                sessionStorage.setItem(testKey, 'test value');
                const value = sessionStorage.getItem(testKey);
                sessionStorage.removeItem(testKey);
                
                if (value === 'test value') {
                    div.innerHTML = '<span class="success">‚úÖ SessionStorage —Ä–∞–±–æ—Ç–∞–µ—Ç</span>';
                } else {
                    throw new Error('Value mismatch');
                }
            } catch (e) {
                div.innerHTML = '<span class="error">‚ùå SessionStorage –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç: ' + e.message + '</span>';
            }
        }

        function testCookies() {
            const div = document.getElementById('cookie-test');
            try {
                document.cookie = "test=value; path=/";
                const hasCookie = document.cookie.includes('test=value');
                
                if (hasCookie) {
                    div.innerHTML = '<span class="success">‚úÖ Cookies —Ä–∞–±–æ—Ç–∞—é—Ç</span>';
                    div.innerHTML += '<br>All cookies: ' + (document.cookie || '–ü–£–°–¢–û');
                } else {
                    throw new Error('Cookie not set');
                }
            } catch (e) {
                div.innerHTML = '<span class="error">‚ùå Cookies –ù–ï —Ä–∞–±–æ—Ç–∞—é—Ç: ' + e.message + '</span>';
            }
        }

        function testIndexedDB() {
            const div = document.getElementById('indexeddb-test');
            
            if (!window.indexedDB) {
                div.innerHTML = '<span class="error">‚ùå IndexedDB –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</span>';
                return;
            }
            
            const request = indexedDB.open('TestDB', 1);
            
            request.onsuccess = function() {
                div.innerHTML = '<span class="success">‚úÖ IndexedDB —Ä–∞–±–æ—Ç–∞–µ—Ç</span>';
                // –£–¥–∞–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—É—é –ë–î
                indexedDB.deleteDatabase('TestDB');
            };
            
            request.onerror = function() {
                div.innerHTML = '<span class="error">‚ùå IndexedDB –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç</span>';
            };
        }

        // Auto-run tests
        window.onload = () => {
            testLocalStorage();
            testSessionStorage();
            testCookies();
            testIndexedDB();
        };
    </script>
</body>
</html>