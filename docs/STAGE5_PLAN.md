# üèóÔ∏è STAGE 5: UI Component Migration Plan

## üéØ **–¶–ï–õ–¨ –≠–¢–ê–ü–ê**
–†–∞–∑–¥–µ–ª–∏—Ç—å –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π `script.js` (2548 —Å—Ç—Ä–æ–∫) –Ω–∞ –º–æ–¥—É–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã Cursor.

## üìä **–¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï**
- `script.js`: 2548 —Å—Ç—Ä–æ–∫ - —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã Cursor
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ—É–Ω–∫—Ü–∏–π —Å–º–µ—à–∞–Ω—ã –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

## üóÇÔ∏è **–ü–õ–ê–ù –ú–ò–ì–†–ê–¶–ò–ò**

### **5.1 - Overlay Management Module**
**–§–∞–π–ª:** `src/ui/overlay-manager.js`
**–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏:**
- `showMobileSongPreview()` - –ø–æ–∫–∞–∑ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–µ–≤—å—é –ø–µ—Å–Ω–∏
- `hideMobileSongPreview()` - —Å–∫—Ä—ã—Ç–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–µ–≤—å—é
- `displaySongTextInMobileOverlay()` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ –æ–≤–µ—Ä–ª–µ–µ
- `setupMobileOverlayEventListeners()` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª–µ–π —Å–æ–±—ã—Ç–∏–π
- `closeKeySelectionModal()` - –∑–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—ã–±–æ—Ä–∞ –∫–ª—é—á–∞
- `showKeySelectionModal()` - –ø–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—ã–±–æ—Ä–∞ –∫–ª—é—á–∞
- `updateSongTextInModal()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –ø–µ—Å–Ω–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
- `updateKeyButtons()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –∫–ª—é—á–µ–π

### **5.2 - Search Management Module**
**–§–∞–π–ª:** `src/ui/search-manager.js`
**–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏:**
- `performOverlayDropdownSearch()` - –ø–æ–∏—Å–∫ –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ
- `showOverlaySearchResults()` - –ø–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
- `hideOverlaySearchResults()` - —Å–∫—Ä—ã—Ç–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
- `createOverlaySearchResultElement()` - —Å–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ–∏—Å–∫–∞
- `filterAndDisplaySongs()` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Å–µ–Ω
- `cleanLyricsForSearch()` - –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞
- `getHighlightedTextFragment()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞

### **5.3 - Setlist Management Module**
**–§–∞–π–ª:** `src/ui/setlist-manager.js`
**–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏:**
- `handleCreateSetlist()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–ª–∏—Å—Ç–∞
- `startAddingSongs()` - –Ω–∞—á–∞–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Å–µ–Ω
- `addSongToSetlist()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Å–Ω–∏ –≤ —Å–µ—Ç–ª–∏—Å—Ç
- `removeSongFromSetlist()` - —É–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Å–Ω–∏ –∏–∑ —Å–µ—Ç–ª–∏—Å—Ç–∞
- `confirmAddSongWithKey()` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Å–Ω–∏ —Å –∫–ª—é—á–æ–º
- `handleSetlistSelect()` - –≤—ã–±–æ—Ä —Å–µ—Ç–ª–∏—Å—Ç–∞
- `handleSetlistDelete()` - —É–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Ç–ª–∏—Å—Ç–∞
- `refreshSetlists()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–µ—Ç–ª–∏—Å—Ç–æ–≤
- `finishAddingSongs()` - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Å–µ–Ω

### **5.4 - Modal Management Module**
**–§–∞–π–ª:** `src/ui/modal-manager.js`
**–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏:**
- `closeCreateSetlistModal()` - –∑–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ç–ª–∏—Å—Ç–∞
- `closeAddSongsConfirmModal()` - –∑–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- `closeAddSongsOverlay()` - –∑–∞–∫—Ä—ã—Ç–∏–µ –æ–≤–µ—Ä–ª–µ—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Å–µ–Ω
- `closeNotesModal()` - –∑–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∑–∞–º–µ—Ç–æ–∫
- `handleSaveNote()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏
- `showNotification()` - –ø–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### **5.5 - Event Handlers Module**
**–§–∞–π–ª:** `src/ui/event-handlers.js`
**–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏:**
- `handleFavoriteOrRepertoireSelect()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ/—Ä–µ–ø–µ—Ä—Ç—É–∞—Ä–∞
- `handleRepertoireUpdate()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä–∞
- `handleAddSongToSetlist()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Å–Ω–∏ –≤ —Å–µ—Ç–ª–∏—Å—Ç
- `handleRemoveSongFromSetlist()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–µ—Å–Ω–∏ –∏–∑ —Å–µ—Ç–ª–∏—Å—Ç–∞
- `handleAddToRepertoire()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä
- `setupSwipeToClose()` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–≤–∞–π–ø–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
- `setupEventListeners()` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª–µ–π —Å–æ–±—ã—Ç–∏–π

## üîÑ **–ü–†–û–¶–ï–î–£–†–ê –ú–ò–ì–†–ê–¶–ò–ò**

### **–≠—Ç–∞–ø 5.1: Overlay Management**
1. –°–æ–∑–¥–∞—Ç—å `src/ui/overlay-manager.js`
2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–≤–µ—Ä–ª–µ—è–º–∏
3. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ `script.js`
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–≠—Ç–∞–ø 5.2: Search Management**
1. –°–æ–∑–¥–∞—Ç—å `src/ui/search-manager.js`
2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∏—Å–∫–∞
3. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ `script.js`
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–≠—Ç–∞–ø 5.3: Setlist Management**
1. –°–æ–∑–¥–∞—Ç—å `src/ui/setlist-manager.js`
2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ç–ª–∏—Å—Ç–∞–º–∏
3. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ `script.js`
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–≠—Ç–∞–ø 5.4: Modal Management**
1. –°–æ–∑–¥–∞—Ç—å `src/ui/modal-manager.js`
2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
3. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ `script.js`
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–≠—Ç–∞–ø 5.5: Event Handlers**
1. –°–æ–∑–¥–∞—Ç—å `src/ui/event-handlers.js`
2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
3. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ `script.js`
4. –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üéØ **–û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢**
- `script.js` —É–º–µ–Ω—å—à–∏—Ç—Å—è —Å 2548 –¥–æ ~800-1000 —Å—Ç—Ä–æ–∫
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
- –£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –¥–ª—è Cursor
- –ë–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–µ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞ –∫–æ–¥–∞

## üß™ **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï**
–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
- –ó–∞–ø—É—Å–∫ baseline —Ç–µ—Å—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤