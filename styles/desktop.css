/* Desktop-only stylesheet (non-invasive). Activate via <link> at Stage Gate. */

@media (min-width: 1280px) {
	/* Stage 1: Main layout without changing mobile design */

	/* Limit main content width for readability */
	.container {
		max-width: 920px;
		margin-left: auto;
		margin-right: auto;
	}

	/* Desktop: keep mobile bottom nav dock fixed at bottom (as on mobile) */
	.mobile-bottom-nav {
		height: 68px; /* slightly bigger for desktop */
	}

	/* Use base mobile styles; only scale sizes below */

	/* Icon + label colors (labels always visible) */
	.mobile-bottom-nav .mobile-nav-button i {
		font-size: 1.4rem !important; /* up from 1.3rem */
	}

	.mobile-bottom-nav .mobile-nav-button span {
		font-size: 0.8rem !important; /* up from 0.7rem */
	}

	/* Side panels: define consistent desktop widths without altering visuals */
	#setlists-panel,
	#my-list-panel,
	#repertoire-panel {
		width: 360px;
		max-width: 360px;
	}

	/* Shift main content when panels are open (non-invasive, uses :has) */
	body:has(#setlists-panel.open) .container,
	body:has(#my-list-panel.open) .container {
		margin-left: 380px; /* panel width + safe gap */
	}
	body:has(#repertoire-panel.open) .container {
		margin-right: 380px;
	}

	/* Side panels: keep their widths and position; no visual redesign */
	.setlists-panel,
	.my-list-panel,
	.repertoire-panel {
		/* Ensure panels overlay nicely on desktop too without shifting mobile behavior */
	}

	/* Song content: comfortable line length */
	#song-content {
		max-width: 1100px;
		margin-left: auto;
		margin-right: auto;
	}

	/* Reserve space for vertical dock */
	.container {
		padding-left: 0;
		padding-top: 0;
		padding-bottom: 80px; /* reserve space for larger bottom nav */
	}

	/* ===================================== */
	/* Stage 2: Overlays / Modals (desktop) */
	/* ===================================== */

	/* Branch selection modal */
	#branch-selection-modal .modal-content.branch-selection-content {
		max-width: 720px;
		width: 90%;
		margin: 48px auto;
	}

	/* Create setlist modal */
	#create-setlist-modal .overlay-content.create-setlist-content {
		max-width: 520px;
		width: 90%;
		margin: 48px auto;
		padding: 16px;
	}

	/* Setlist select overlay */
	#setlist-select-overlay .modal-content.setlist-select-modal.compact {
		max-width: 720px;
		width: 92%;
		margin: 48px auto;
		padding: 16px;
	}

	/* Song editor overlay */
	#song-editor-overlay .song-editor-modal {
		max-width: 960px;
		width: 92%;
		margin: 48px auto;
		max-height: calc(100vh - 120px);
		padding: 16px;
	}

	/* Key selection preview */
	#key-selection-modal .fullscreen-content.song-preview-content {
		max-width: 960px;
		width: 92%;
		margin: 24px auto;
		height: calc(100vh - 140px);
		padding: 16px;
	}

	/* Add songs fullscreen overlay */
	#add-songs-overlay .fullscreen-content {
		max-width: 1200px;
		width: 96%;
		margin: 0 auto;
		height: calc(100vh - 100px);
		padding: 16px;
	}

	/* Metronome overlay */
	#metronome-overlay .metronome-modal {
		max-width: 720px;
		width: 92%;
		margin: 48px auto;
		padding: 16px;
	}

	/* Typography tweaks for readability */
	#song-editor-overlay .song-editor-content textarea.song-edit-textarea {
		font-size: 0.98rem;
		line-height: 1.5;
	}

	#key-selection-modal .song-text-display,
	#add-songs-overlay .songs-grid,
	#setlist-select-overlay .modal-body.compact {
		line-height: 1.45;
	}

	/* Search area: align with content width */
	.controls {
		max-width: 920px;
		margin-left: auto;
		margin-right: auto;
	}

	/* =============================== */
	/* Stage 3: Events page (desktop) */
	/* =============================== */

	/* Center page and create two-column layout: calendar | events list */
	.events-page-container {
		max-width: 1200px;
		margin-left: auto;
		margin-right: auto;
		display: grid;
		grid-template-columns: 520px minmax(0, 1fr);
		grid-template-rows: auto 1fr;
		grid-template-areas:
			"top top"
			"cal list";
		height: 100vh;
		gap: 0;
	}

	.events-top-bar {
		grid-area: top;
		position: sticky;
		top: 0;
		z-index: 30;
	}

	.calendar-section {
		grid-area: cal;
		border-right: 1px solid var(--border-color);
		overflow-y: auto;
	}

	.selected-date-events {
		grid-area: list;
		overflow-y: auto;
		max-width: 760px;
		margin-left: auto;
		margin-right: auto;
	}

	/* List view: hide calendar column and make list span the layout */
	body:has(.events-list-view) .events-page-container {
		grid-template-columns: minmax(0, 1fr);
		grid-template-areas:
			"top"
			"list";
		/* ensure list row can truly fill viewport */
		grid-template-rows: auto minmax(0, 1fr);
	}

	/* Fallback without :has(): use body.events-list-active */
	body.events-list-active .events-page-container {
		grid-template-columns: minmax(0, 1fr);
		grid-template-areas:
			"top"
			"list";
		grid-template-rows: auto minmax(0, 1fr);
	}

	body:has(.events-list-view) .calendar-section {
		display: none;
	}
	body.events-list-active .calendar-section {
		display: none;
	}

	body:has(.events-list-view) .selected-date-events {
		max-width: 920px; /* шире для списка */
		padding-left: 1.5rem;
		padding-right: 1.5rem;
		height: 100%;
		display: flex;
		flex-direction: column;
		overflow: hidden; /* внутренний список прокручиваем */
	}
	body.events-list-active .selected-date-events {
		max-width: 920px;
		padding-left: 1.5rem;
		padding-right: 1.5rem;
		height: 100%;
		display: flex;
		flex-direction: column;
		overflow: hidden;
	}

	/* Compact list view cards for better density */
	body:has(.events-list-view) .events-list {
		gap: 0.5rem;
		flex: 1 1 auto;
		overflow-y: auto;
	}

	/* Sticky subheader inside list for better UX */
	body:has(.events-list-view) .selected-date-header {
		position: sticky;
		top: 0;
		z-index: 10;
		background: var(--bg-primary);
		border-bottom: 1px solid var(--border-color);
		margin-bottom: 0.5rem;
	}

	body:has(.events-list-view) .month-section-title {
		font-size: 1rem;
		margin-bottom: 0.5rem;
		padding-bottom: 0.25rem;
	}

	body:has(.events-list-view) .month-events {
		gap: 0.5rem;
	}

	body:has(.events-list-view) .event-card {
		padding: 0.75rem;
		border-radius: 10px;
	}

	body:has(.events-list-view) .event-header-redesigned {
		margin-bottom: 0.5rem;
	}

	body:has(.events-list-view) .event-name {
		font-size: 1rem;
	}

	body:has(.events-list-view) .event-date,
	body:has(.events-list-view) .event-time {
		font-size: 0.8125rem;
	}

	body:has(.events-list-view) .event-leader {
		font-size: 0.8125rem;
		margin: 0.25rem 0;
	}

	body:has(.events-list-view) .event-participants-compact {
		font-size: 0.78rem;
		gap: 0.2rem;
		margin-top: 0.25rem;
	}

	body:has(.events-list-view) .instrument-line {
		font-size: 0.78rem;
	}

	body:has(.events-list-view) .event-footer {
		margin-top: 0.5rem;
		padding-top: 0.5rem;
	}

	body:has(.events-list-view) .event-count {
		font-size: 0.75rem;
	}

	body:has(.events-list-view) .event-actions .icon-button {
		width: 28px;
		height: 28px;
	}

	/* Tighter paddings for desktop */
	.calendar-grid {
		padding: 0.5rem 1rem 1rem;
	}

	.selected-date-events {
		padding: 1rem 1.25rem;
	}

	/* Slightly larger date visuals for desktop */
	.calendar-day {
		margin: 3px;
	}

	.calendar-day-number {
		font-size: 1.05rem;
	}
}

@media (min-width: 1440px) {
	/* Larger desktop tweaks */
}

/* ================================ */
/* Main page: controls (desktop)   */
/* ================================ */
@media (min-width: 1280px) {
	/* 1) "Все песни" — крупнее на десктопе */
	.songs-button-container .songs-overlay-button {
		height: 44px;
		padding: 10px 14px;
		font-size: 0.95rem;
		border: 1px solid #374151;
		background: #1a1f2e;
		color: #e5e7eb;
		border-radius: 10px;
		min-width: 240px;
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: 8px;
	}

	.songs-button-container .songs-overlay-button i {
		font-size: 1rem;
		color: #e5e7eb;
	}

	.songs-button-container .songs-overlay-button:hover {
		background: #22d3ee;
		border-color: #22d3ee;
		color: #111827;
	}

	.songs-button-container .songs-overlay-button:hover i {
		color: #111827;
	}

	/* 2) Кнопки режимов: иконки без текста на десктопе */
	#toggle-chords-button .button-text,
	#chords-only-button .button-text,
	#split-text-button .button-text,
	#copy-text-button .button-text {
		display: none !important;
	}

	#toggle-chords-button,
	#chords-only-button,
	#split-text-button,
	#copy-text-button {
		width: 44px;
		height: 44px;
		padding: 0;
		display: inline-flex;
		align-items: center;
		justify-content: center;
	}

	#chords-only-button .text-icon {
		display: inline-block;
		font-size: 1rem;
		color: #e5e7eb;
		line-height: 1;
	}

	#toggle-chords-button i {
		font-size: 1rem;
		color: #e5e7eb;
	}

	#toggle-chords-button:hover i,
	#chords-only-button:hover .text-icon {
		color: #111827;
	}

	/* Unify icon sizing/centering for functional buttons */
	.function-buttons-group .icon-button i,
	.font-size-controls .icon-button i {
		font-size: 1rem;
		line-height: 1;
		display: inline-block;
		margin: 0;
	}

	#chords-only-button .text-icon {
		font-size: 1rem;
		line-height: 1;
		display: inline-block;
		margin: 0;
	}

	/* Slight left gap for key selector */
	.key-group {
		margin-left: 12px;
	}

	/* Dark-themed key select (desktop) */
	#key-select {
		background: #1f2937;
		border: 1px solid #374151;
		color: #e5e7eb;
		padding: 8px 12px;
		border-radius: 8px;
		appearance: auto;
		background-image: none;
		display: inline-block;
		min-width: 88px;
		height: 40px;
		line-height: 1.2;
		font-size: 0.95rem;
		box-sizing: border-box;
	}

	#key-select:focus {
		outline: none;
		border-color: #22d3ee;
		box-shadow: 0 0 0 3px rgba(34, 211, 238, 0.15);
	}

	#key-select option {
		background: #111827;
		color: #e5e7eb;
	}

	/* 3) Оверлей "Все песни" — более удобный вид: грид карточек */
	.songs-overlay .songs-overlay-content {
		max-width: 560px;
		width: 92%;
		height: calc(100vh - 80px);
		max-height: calc(100vh - 80px);
		display: flex;
		flex-direction: column;
	}

	.songs-overlay .songs-list-container {
		flex: 1 1 auto;
		overflow-y: auto;
	}

	.songs-overlay .songs-list {
		display: flex;
		flex-direction: column;
		gap: 8px;
		overflow: visible;
		padding-right: 4px;
	}

	.songs-overlay .song-item {
		background: var(--bg-secondary);
		border: 1px solid var(--border-color);
		border-radius: 10px;
		padding: 10px;
		transition: border-color 0.2s ease, background-color 0.2s ease, transform 0.1s ease;
	}

	.songs-overlay .song-item:hover {
		background: var(--hover-bg);
		border-color: var(--primary-color);
		transform: translateY(-1px);
	}

	.songs-overlay .song-name {
		color: var(--text-primary);
		font-size: 0.95rem;
		line-height: 1.2;
	}

	/* Card-like row layout for song items */
	.songs-overlay .song-item {
		display: grid;
		grid-template-columns: 1fr auto;
		align-items: center;
	}
}

@media (min-width: 1440px) {
	/* Widen main 'Все песни' button on very wide screens */
	.songs-button-container .songs-overlay-button {
		min-width: 280px;
	}
}

/* ================================ */
/* Stage 5: Settings page (desktop) */
/* ================================ */
@media (min-width: 1280px) {
	/* Wider, centered settings container */
	.settings-container {
		max-width: 900px; /* было 600px в мобильном */
		margin-left: auto;
		margin-right: auto;
	}

	/* Make user header more spacious */
	.user-info-section {
		padding: 32px 28px;
	}

	/* Sections spacing */
	.settings-sections {
		padding: 24px 28px;
	}

	.settings-section {
		padding: 22px;
	}

	/* Compact items for density */
	.settings-item {
		padding: 10px 0;
	}

	/* Branch actions buttons alignment */
	.branch-actions {
		gap: 12px;
	}

	/* Modal widths slightly larger on desktop */
	.modal .modal-content {
		max-width: 560px;
	}
}

/* ====================================== */
/* Stage 6: Accessibility & contrast (desktop) */
/* ====================================== */
@media (min-width: 1280px) {
	/* Focus-visible outlines for interactive elements */
	.icon-button:focus-visible,
	.btn:focus-visible,
	.settings-link:focus-visible,
	.action-button:focus-visible,
	.logout-button:focus-visible,
	.mobile-bottom-nav .mobile-nav-button:focus-visible,
	.event-card:focus-within {
		outline: 2px solid #22d3ee;
		outline-offset: 2px;
		box-shadow: 0 0 0 3px rgba(34, 211, 238, 0.35);
	}

	/* Ensure dark text/icons on blue hover backgrounds (scoped) */
	.events-page-container .icon-button:hover,
	.settings-container .icon-button:hover,
	.mobile-bottom-nav .mobile-nav-button:hover {
		color: #111827 !important; /* dark text/icons on blue */
	}

	/* Bottom nav hover on desktop: blue bg with dark text */
	.mobile-bottom-nav .mobile-nav-button:hover {
		background: #22d3ee;
		border-color: #22d3ee;
	}

	/* Emphasize keyboard focus on event cards */
	.event-card:focus-within {
		border-color: #22d3ee;
		box-shadow: 0 0 0 3px rgba(34, 211, 238, 0.2);
	}
}