<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agape Worship</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="manifest" href="manifest.json">  </head>
<body>

<div id="notes-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <h3 class="modal-title">–ó–∞–º–µ—Ç–∫–∞ –∫ –ø–µ—Å–Ω–µ</h3>
        <textarea id="note-edit-textarea" rows="6" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞–º–µ—Ç–∫–∏..."></textarea>
        <div class="modal-actions">
            <button id="save-note-button" class="modal-button primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button id="cancel-note-button" class="modal-button secondary">–û—Ç–º–µ–Ω–∞</button>
        </div>
        <button id="close-note-modal-x" class="modal-close-x">&times;</button>
    </div>
</div>

<header>
    <h1>Agape Worship</h1>
    <button id="theme-toggle-button" class="theme-toggle" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
      <span class="theme-toggle-bg">
        <i class="fas fa-moon theme-icon moon"></i>
        <i class="fas fa-sun theme-icon sun"></i>
      </span>
      <span class="theme-toggle-slider">
        <i class="fas fa-moon"></i>
      </span>
    </button>
</header>

<main class="container">
    <section class="controls">
        <fieldset class="search-group">
            <legend>–ü–æ–∏—Å–∫</legend>
            <input type="text" id="search-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Å–Ω–∏...">
            <div id="search-results"></div>
        </fieldset>
        <div class="select-filters-container">
            <div class="filter-group">
                <select id="sheet-select">
                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é --</option>
                </select>
            </div>
            <div class="filter-group">
                <select id="song-select">
                    <option value="">-- –ü–µ—Å–Ω—è --</option>
                </select>
            </div>
        </div>
        <div class="control-group">
            <fieldset class="key-group">
                <legend>–¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</legend>
                <select id="key-select">
                    <option value="C">C</option>
                    <option value="C#">C#</option>
                    <option value="D">D</option>
                    <option value="D#">D#</option>
                    <option value="E">E</option>
                    <option value="F">F</option>
                    <option value="F#">F#</option>
                    <option value="G">G</option>
                    <option value="G#">G#</option>
                    <option value="A">A</option>
                    <option value="A#">A#</option>
                    <option value="H">H</option>
                </select>
            </fieldset>
            <div class="function-buttons-group">
                <button id="toggle-chords-button" class="control-group-button icon-button simple" title="–°–∫—Ä—ã—Ç—å –∞–∫–∫–æ—Ä–¥—ã">
                    <i class="fas fa-guitar"></i>
                    <span class="button-text">–ê–∫–∫–æ—Ä–¥—ã</span>
                </button>
                <button id="chords-only-button" class="control-group-button icon-button simple" title="–ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–∫–∫–æ—Ä–¥—ã">
                    <span class="text-icon">T</span>
                    <span class="button-text">–¢–æ–ª—å–∫–æ –∞–∫–∫–æ—Ä–¥—ã</span>
                </button>
                <button id="split-text-button" aria-label="–†–∞–∑–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç" class="control-group-button icon-button simple">
                    <i class="fas fa-columns"></i>
                    <span class="button-text">–†–∞–∑–¥–µ–ª–∏—Ç—å</span>
                </button>
            </div>
            <div class="font-size-controls">
                <button id="zoom-out" class="icon-button simple" title="–£–º–µ–Ω—å—à–∏—Ç—å —à—Ä–∏—Ñ—Ç"><i class="fas fa-search-minus"></i></button>
                <button id="zoom-in" class="icon-button simple" title="–£–≤–µ–ª–∏—á–∏—Ç—å —à—Ä–∏—Ñ—Ç"><i class="fas fa-search-plus"></i></button>
            </div>
        </div>
    </section>

    <fieldset id="song-content">
        <legend id="song-title">
            <span class="song-title-text">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Å–Ω—é</span>
            <button id="edit-song-button" class="icon-button simple legend-button" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Å–Ω—é" style="display: none;">
                <i class="fas fa-edit"></i>
            </button>
        </legend>
        <div class="song-actions-legend-row">
            <div class="song-legend-action" data-legend="–ú–æ–π —Å–ø–∏—Å–æ–∫">
                <button id="favorite-button" class="legend-icon-btn heart" aria-label="–î–æ–±–∞–≤–∏—Ç—å –≤ –ú–æ–π —Å–ø–∏—Å–æ–∫" title="–î–æ–±–∞–≤–∏—Ç—å –≤ –ú–æ–π —Å–ø–∏—Å–æ–∫">
                    <i class="far fa-heart"></i>
                </button>
            </div>
            <div class="song-legend-action" data-legend="–°–µ—Ç –ª–∏—Å—Ç">
                <button id="add-to-setlist-button" class="legend-icon-btn setlist" aria-label="–î–æ–±–∞–≤–∏—Ç—å –≤ —Å–µ—Ç-–ª–∏—Å—Ç" title="–î–æ–±–∞–≤–∏—Ç—å –≤ —Å–µ—Ç-–ª–∏—Å—Ç">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
            <div class="song-legend-action" data-legend="–†–µ–ø–µ—Ä—Ç—É–∞—Ä">
                <button id="repertoire-button" class="legend-icon-btn mic" aria-label="–í —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä–µ" title="–í —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä–µ">
                    <i class="fas fa-microphone"></i>
                </button>
            </div>
        </div>
        <div class="song-controls">
            <button id="copy-text-button" class="icon-button simple" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –ø–µ—Å–Ω–∏" style="display: none;">
                <i class="far fa-copy"></i>
            </button>
        </div>
        <pre id="song-display"></pre>
    </fieldset>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ -->
    <div id="song-editor-overlay" class="song-editor-overlay">
        <div class="song-editor-modal">
            <div class="song-editor-header">
                <h3 id="song-editor-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Å–Ω–∏</h3>
                <button id="close-editor-button" class="icon-button simple" title="–ó–∞–∫—Ä—ã—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="song-editor-content">
                <div class="editor-info">
                    <span id="edit-status-info">üìÑ –û—Ä–∏–≥–∏–Ω–∞–ª –∏–∑ Google –¢–∞–±–ª–∏—Ü—ã</span>
                    <button id="revert-to-original-button" class="editor-button revert" style="display: none;">
                        <i class="fas fa-undo"></i>
                        –í–µ—Ä–Ω—É—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª
                    </button>
                </div>
                
                <textarea id="song-edit-textarea" class="song-edit-textarea" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –ø–µ—Å–Ω–∏ —Å –∞–∫–∫–æ—Ä–¥–∞–º–∏..."></textarea>
            </div>
            
            <div class="song-editor-footer">
                <div class="editor-controls">
                    <button id="save-edit-button" class="editor-button save">
                        <i class="fas fa-save"></i>
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button id="cancel-edit-button" class="editor-button cancel">
                        <i class="fas fa-times"></i>
                        –û—Ç–º–µ–Ω–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>



     <section id="youtube-player-section" style="margin-top: 20px; display: none;">
         <h3>–í–∏–¥–µ–æ / –ê—É–¥–∏–æ</h3>
         <p id="youtube-video-key-display" style="text-align: center; margin-bottom: 10px; display: none; font-size: 0.9rem; color: var(--label-color);"></p>
         <div id="youtube-player-container" style="max-width: 100%; margin: auto;">
             </div>
     </section>

    <div class="controls-footer">
        <div class="bpm-controls">
            <span>–†–∞–∑–º–µ—Ä: </span>
            <select id="time-signature">
                <option value="4">4/4</option>
                <option value="3">3/4</option>
                <option value="6">6/8</option>
                <option value="2">2/4</option>
            </select>
            <span>BPM: </span>
            <span id="bpm-display" contenteditable="true">N/A</span>
            <button id="metronome-button" aria-label="–í–∫–ª—é—á–∏—Ç—å –º–µ—Ç—Ä–æ–Ω–æ–º">
                <i class="fas fa-play"></i>
                <span class="button-text">–ú–µ—Ç—Ä–æ–Ω–æ–º</span>
            </button>
        </div>
        <a id="holychords-button" href="#" target="_blank">Holychords</a>
        <button id="add-to-repertoire-button" aria-label="–î–æ–±–∞–≤–∏—Ç—å –≤ –º–æ–π —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä">üé§ –í —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä</button>
    </div>
</main>

<aside id="setlists-panel" class="side-panel setlists-panel">
    <button class="side-panel-close-btn icon-button simple" title="–ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å"><i class="fas fa-chevron-left"></i></button>
    <div class="list-section setlist-section">
        <h3>–°–µ—Ç-–ª–∏—Å—Ç—ã</h3>
        <div class="create-setlist-form">
            <input type="text" id="new-setlist-name-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ç-–ª–∏—Å—Ç–∞...">
            <button id="create-setlist-button" title="–°–æ–∑–¥–∞—Ç—å —Å–µ—Ç-–ª–∏—Å—Ç">–°–æ–∑–¥–∞—Ç—å</button>
        </div>
        <div id="setlists-list-container" class="list-container setlists-list">
            <div class="empty-message">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ç-–ª–∏—Å—Ç–æ–≤...</div>
        </div>
    </div>

    <div class="list-section current-setlist-section">
        <h3 id="current-setlist-title">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ç-–ª–∏—Å—Ç</h3>
        <div class="current-setlist-controls" style="display: none;">
            <button id="start-presentation-button" title="–ù–∞—á–∞—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è —ç—Ç–æ–≥–æ —Å–µ—Ç-–ª–∏—Å—Ç–∞">
                <i class="fas fa-play"></i> –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è
            </button>
            <button id="delete-setlist-button" title="–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Å–µ—Ç-–ª–∏—Å—Ç">
                <i class="fas fa-trash-alt"></i> –£–¥–∞–ª–∏—Ç—å
            </button>
        </div>
        <div id="current-setlist-songs-container" class="list-container current-setlist-songs">
            <div class="empty-message">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ç-–ª–∏—Å—Ç</div>
        </div>
    </div>
</aside>

<aside id="my-list-panel" class="side-panel my-list-panel">
    <button class="side-panel-close-btn icon-button simple" title="–ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å"><i class="fas fa-chevron-left"></i></button>
    <div id="my-list" class="list-section">
        <h3>–ú–æ–π —Å–ø–∏—Å–æ–∫</h3>
        <div id="favorites-list" class="list-container">
            <div class="empty-message">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
    </div>
</aside>

<aside id="repertoire-panel" class="side-panel repertoire-panel">
    <button class="side-panel-close-btn icon-button simple" title="–ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å"><i class="fas fa-chevron-right"></i></button>
    <h3 class="panel-header">–†–µ–ø–µ—Ä—Ç—É–∞—Ä</h3>

    <div class="repertoire-vocalist-selector">
        <label for="vocalist-select">–í–æ–∫–∞–ª–∏—Å—Ç:</label>
        <select id="vocalist-select">
            <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –≤–æ–∫–∞–ª–∏—Å—Ç–∞ --</option>
            </select>
    </div>

    <div class="repertoire-view-controls">
        <button id="repertoire-view-key" class="repertoire-view-button active" title="–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏">
            <i class="fas fa-key"></i> <span class="button-text-rp">–ü–æ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏</span>
        </button>
        <button id="repertoire-view-sheet" class="repertoire-view-button" title="–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ª–∏—Å—Ç–∞–º">
            <i class="far fa-file-alt"></i> <span class="button-text-rp">–ü–æ –ª–∏—Å—Ç–∞–º</span>
        </button>
        <button id="repertoire-view-all" class="repertoire-view-button" title="–ü–æ–∫–∞–∑–∞—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ">
            <i class="fas fa-sort-alpha-down"></i> <span class="button-text-rp">–í–µ—Å—å —Å–ø–∏—Å–æ–∫</span>
        </button>
    </div>
    <div id="repertoire-panel-list" class="repertoire-list-container list-container">
        <div class="empty-message">–í—ã–±–µ—Ä–∏—Ç–µ –≤–æ–∫–∞–ª–∏—Å—Ç–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä–∞.</div>
        </div>
</aside>

<div id="presentation-overlay" class="presentation-overlay">
    <button id="presentation-close-btn" class="presentation-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å —Ä–µ–∂–∏–º –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏">&times;</button>
    <button id="pres-split-text-btn" class="presentation-control-btn" title="–†–∞–∑–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç">
        <i class="fas fa-columns"></i>
    </button>
    <div class="presentation-controls">
        <button id="pres-prev-btn" class="presentation-nav-btn" title="–ü—Ä–µ–¥—ã–¥—É—â–∞—è –ø–µ—Å–Ω—è">
            <i class="fas fa-chevron-left"></i>
        </button>
        <span id="pres-counter" class="presentation-counter">0 / 0</span>
        <button id="pres-next-btn" class="presentation-nav-btn" title="–°–ª–µ–¥—É—é—â–∞—è –ø–µ—Å–Ω—è">
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>
    <div id="presentation-content" class="presentation-content">
        </div>
</div>

<div id="loading-indicator">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

<nav class="mobile-bottom-nav">
    <button id="toggle-favorites" class="mobile-nav-button">
        <i class="fas fa-list-alt"></i>
        <span>–°–µ—Ç-–ª–∏—Å—Ç—ã</span>
    </button>
    <button id="toggle-my-list" class="mobile-nav-button">
        <i class="fas fa-heart"></i>
        <span>–ú–æ–π —Å–ø–∏—Å–æ–∫</span>
    </button>
    <button id="toggle-repertoire" class="mobile-nav-button">
        <i class="fas fa-users"></i>
        <span>–†–µ–ø–µ—Ä—Ç—É–∞—Ä</span>
    </button>
</nav>

  <script type="module" src="script.js"></script>

    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('sw.js')
            .then(registration => {
              console.log('Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration);
            })
            .catch(error => {
              console.log('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', error);
            });
        });
      }
    </script>
</body>
</html>
